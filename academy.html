<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Partner Academy — PanAfric Properties</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<script src="academy.js"></script>
<script src="modules.js"></script>
<script>
papRequirePartner();
</script>

<section class="section">
  <div class="wrap">
    <div class="card" style="padding:18px 18px;">
      <h2 style="margin-bottom:6px;">Partner Academy</h2>
      <p class="small" id="welcome"></p>

      <div class="grid" style="margin-top:12px;">
        <div class="card">
          <h3 style="margin:0 0 6px;">Progress</h3>
          <p class="small" id="progressText"></p>
          <p class="small" style="opacity:.8;">Complete all modules to unlock certification.</p>
        </div>

        <div class="card">
          <h3 style="margin:0 0 6px;">Certification</h3>
          <p class="small" id="certStatus"></p>
          <a class="btn green" id="certBtn" href="certificate.html" style="display:none; margin-top:10px;">View Certificate</a>
        </div>

        <div class="card">
          <h3 style="margin:0 0 6px;">Session</h3>
          <p class="small"><a href="#" onclick="doLogout(); return false;">Log out</a></p>
        </div>
      </div>
    </div>

    <h2 style="margin-top:18px;">Modules</h2>

    <div class="grid" id="modulesGrid"></div>
  </div>
</section>

<script>
function doLogout() {
  papLogout();
  window.location.href = "login.html";
}

const name = localStorage.getItem(PAP.keys.partnerName) || "Partner";
const email = localStorage.getItem(PAP.keys.partnerEmail) || "";
document.getElementById("welcome").innerText = `Welcome, ${name} (${email}).`;

const { passed, pct } = papPercentComplete(TOTAL_MODULES);
document.getElementById("progressText").innerText = `${passed} / ${TOTAL_MODULES} modules completed (${pct}%).`;

const allDone = passed === TOTAL_MODULES;
document.getElementById("certStatus").innerText = allDone
  ? "Unlocked — you have completed all modules."
  : "Locked — complete all modules to unlock.";

if (allDone) document.getElementById("certBtn").style.display = "inline-block";

const grid = document.getElementById("modulesGrid");
MODULES.forEach(m => {
  const done = papIsModulePassed(m.id);
  const card = document.createElement("a");
  card.className = "card";
  card.href = `module.html?m=${m.id}`;
  card.style.textDecoration = "none";
  card.innerHTML = `
    <h3>Module ${m.id}</h3>
    <p class="small">${m.title}</p>
    <p class="small" style="margin-top:8px;"><strong>Status:</strong> ${done ? "Completed ✅" : "Not completed"}</p>
  `;
  grid.appendChild(card);
});
</script>

</body>
</html>
